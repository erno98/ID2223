# ID2223

This repository contains solutions for the ID2223 Scalable Machine Learning and Deep Learning course at KTH.

# Lab 1
Contained within the `serverless-ml-intro` directory with following structure: 
```
serverless-ml-intro
│   requirements.txt   ← requirements for the whole project 
│
└───iris                              ← project for the Iris dataset
│   │   iris-batch-inference-pipeline.py ← prediction pipeline
│   │   iris-feature-pipeline-daily.py   ← daily prediction
│   │   iris-feature-pipeline.py         ← creating feature group
│   │   iris-training-pipeline.py        ← training pipeline
│   └───huggingface-spaces-iris            ← huggingface app for predictions
│       │   README.md
│       │   app.py
│       │   requirements.txt
│   └───huggingface-spaces-iris-monitor    ← huggingface app for monitoring predictions
│       │   README.md
│       │   app.py
│       │   requirements.txt
│   
└───titanic                             ← project for the Titanic dataset
│   │   titanic-batch-inference-pipeline.py ← prediction pipeline
│   │   titanic-feature-pipeline-daily.py   ← daily prediction
│   │   titanic-feature-pipeline.py         ← creating feature group
│   │   titanic-training-pipeline.py        ← training pipeline
│   │   preprocess_titanic.ipynb            ← notebook for processing the titanic data
│   └───huggingface-spaces-titanic            ← huggingface app for predictions
│       │   README.md
│       │   app.py
│       │   requirements.txt
│   └───huggingface-spaces-titanic-monitor    ← huggingface app for monitoring predictions
│       │   README.md
│       │   app.py
│       │   requirements.txt
```
Apart from the aforementioned, there are pictures, files, and datasets generated by the described scripts.

The huggingface apps are available under following links:
- Iris predictions: https://huggingface.co/spaces/Danker/ID2223_iris
- Iris monitoring (daily): https://huggingface.co/spaces/Danker/iris_daily
- **Titanic** predictions: https://huggingface.co/spaces/Danker/ID2223_Titanic
- **Titanic** monitoring (daily): https://huggingface.co/spaces/Danker/titanic_daily

## Titanic data processing
The raw titanic data was processed to fit out prediction model (in our case, **Random Forest Classifier** (RFC) from sklearn). Following changes has been done:
- attribute Embarked was made numerical (S→0, C→1, Q→2)
- attribute Sex was made numerical (female→1, male→0)
- non-predictive attributes were dropped: PassengerId, Name, Ticket, Cabin
- rows containing empty (NaN) values were dropped from the dataset
- the whole dataset was cast as containing float values (due to some issues with hopsworks)

The RFC was trained using 0.2 train-test-split fraction, achieving accuracy of 79% on the test set.
